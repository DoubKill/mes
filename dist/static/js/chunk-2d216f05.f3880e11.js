(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d216f05"],{c530:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{"margin-top":"25px"}},[r("el-form",{attrs:{inline:!0}},[r("el-form-item",{attrs:{label:"角色"}},[r("el-input",{on:{input:e.groupCodeChanged},model:{value:e.group_code,callback:function(t){e.group_code=t},expression:"group_code"}})],1),r("el-form-item",{attrs:{label:"角色名"}},[r("el-input",{on:{input:e.nameChanged},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","highlight-current-row":""},on:{"current-change":e.handleGroupsCurrentRowChange}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"No",width:"50"}}),r("el-table-column",{attrs:{prop:"group_code",label:"角色代码"}}),r("el-table-column",{attrs:{prop:"name",label:"角色名称"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.permissionObj.group_user.indexOf("change")>-1?r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.showAddGroupUsersDialog(t.row)}}},[e._v("编辑 ")]):e._e()]}}])})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form",{attrs:{inline:!0}}),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.usersByGroup,border:""}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"No",width:"50"}}),r("el-table-column",{attrs:{prop:"username",label:"用户名"}})],1)],1)],1),r("el-dialog",{attrs:{title:e.addGroupUsersTitle,visible:e.dialogAddGroupUsersDialogVisible},on:{"update:visible":function(t){e.dialogAddGroupUsersDialogVisible=t}}},[r("el-form",{attrs:{"label-width":e.formLabelWidth}},[r("el-form-item",{attrs:{label:"用户"}},[r("el-transfer",{attrs:{props:{key:"id",label:"username"},titles:["可用 用户","选中的 用户"],data:e.users},model:{value:e.selectedUsers,callback:function(t){e.selectedUsers=t},expression:"selectedUsers"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogAddGroupUsersDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleAddGroupUsersDialog}},[e._v("确 定")])],1)],1),r("page",{attrs:{total:e.total,"current-page":e.getParams.page},on:{currentChange:e.currentChange}})],1)},a=[],o=(r("b0c0"),r("5530")),n=r("b775"),l=r("99b1");function i(e){return Object(n["a"])({url:l["a"].GroupUrl,method:"get",params:e})}function u(e){return Object(n["a"])({url:l["a"].UsersByGroupUrl,method:"get",params:e})}function c(e,t){return Object(n["a"])({url:l["a"].GroupAddUserUrl+t+"/",method:"put",data:e})}var d=r("3e51"),p=r("2f62"),g={components:{page:d["a"]},data:function(){return{formLabelWidth:"auto",tableData:[],groupsCurrentRow:null,usersByGroup:[],dialogAddGroupUsersDialogVisible:!1,addGroupUsersTitle:"",users:[],selectedUsers:[],currentPage:1,getParams:{page:1},total:0,group_code:"",name:""}},computed:Object(o["a"])({},Object(p["b"])(["permission"])),created:function(){this.permissionObj=this.permission,this.getGroupList()},methods:{getGroupList:function(){var e=this;i(this.getParams).then((function(t){e.tableData=t.results,e.total=t.count}))},groupCodeChanged:function(){this.getParams.page=1,this.beforeGetData(),this.getGroupList()},nameChanged:function(){this.getParams.page=1,this.beforeGetData(),this.getGroupList()},beforeGetData:function(){this.getParams["group_code"]=this.group_code,this.getParams["name"]=this.name},getUsersByGrouplist:function(){var e=this;u().then((function(t){e.users=t.results}))},handleGroupsCurrentRowChange:function(e){if(e){var t=this;this.groupsCurrentRow=e,u({groups:e.id}).then((function(e){for(var r in t.usersByGroup=e.results,t.selectedUsers=[],t.usersByGroup)t.selectedUsers.push(t.usersByGroup[r].id)})).catch((function(e){this.$message.error(e)}))}},showAddGroupUsersDialog:function(e){this.getUsersByGrouplist(),this.addGroupUsersTitle="编辑"+e.name+"所属用户",this.dialogAddGroupUsersDialogVisible=!0},handleAddGroupUsersDialog:function(){var e=this;c({group_users:e.selectedUsers},e.groupsCurrentRow.id).then((function(t){e.$message(e.groupsCurrentRow.name+"修改成功"),e.handleGroupsCurrentRowChange(e.groupsCurrentRow),e.dialogAddGroupUsersDialogVisible=!1}))},currentChange:function(e){this.getParams.page=e,this.getGroupList()}}},h=g,m=r("2877"),b=Object(m["a"])(h,s,a,!1,null,"16420c1c",null);t["default"]=b.exports}}]);