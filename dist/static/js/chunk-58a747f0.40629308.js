(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58a747f0"],{"13d5":function(e,t,a){"use strict";var n=a("23e7"),i=a("d58f").left,s=a("a640"),r=a("ae40"),l=s("reduce"),o=r("reduce",{1:0});n({target:"Array",proto:!0,forced:!l||!o},{reduce:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"2c93":function(e,t,a){"use strict";a("ac1f"),a("841c");var n=a("ed08");t["a"]={created:function(){var e=Object(n["b"])(),t=Object(n["b"])(new Date(new Date-2592e6));this.search.date=[t,e];var a=this.search.date;this.search.st=a?a[0]:"",this.search.et=a?a[1]:""}}},"3e59":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"时间:"}},[a("el-date-picker",{attrs:{clearable:!1,type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},on:{change:e.changeDate},model:{value:e.search.date,callback:function(t){e.$set(e.search,"date",t)},expression:"search.date"}})],1),a("el-form-item",[a("el-radio-group",{on:{change:e.changeRadio},model:{value:e.search.day_type,callback:function(t){e.$set(e.search,"day_type",t)},expression:"search.day_type"}},[a("el-radio",{attrs:{label:1}},[e._v("自然日")]),a("el-radio",{attrs:{label:2}},[e._v("工厂时间")])],1)],1),a("br"),a("el-form-item",{attrs:{label:"时间跨度:"}},[a("time-span-select",{attrs:{"default-val":e.search.dimension,"day-type":e.search.day_type},on:{changeSelect:e.timeSpanChanged}})],1),a("el-form-item",{attrs:{label:"设备编码:"}},[a("equip-select",{attrs:{equip_no_props:e.search.equip_no},on:{"update:equip_no_props":function(t){return e.$set(e.search,"equip_no",t)},changeSearch:e.equipChanged}})],1),a("el-form-item",{attrs:{label:"时间单位:"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.timeUnit,callback:function(t){e.timeUnit=t},expression:"timeUnit"}},e._l(e.options,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",[a("el-button",{on:{click:e.viewGraph}},[e._v("密炼时间占比曲线图")])],1)],1),a("el-table",{attrs:{data:e.tableData,border:"","show-summary":"","summary-method":e.getSummaries}},[a("el-table-column",{attrs:{type:"index",label:"No",width:"60"}}),a("el-table-column",{attrs:{label:3===e.search.dimension?"月份":1===e.search.dimension?"班次":"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.date))]),1===e.search.dimension?a("span",[e._v("/"+e._s(t.row.classes))]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"equip_no",label:"设备编码"}}),a("el-table-column",{attrs:{prop:"total_trains",label:"总车数"}}),a("el-table-column",{attrs:{prop:"total_time",label:"总耗时/"+("秒"===e.timeUnit?"s":"min")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["秒"===e.timeUnit?a("span",[e._v(e._s(n.total_time))]):a("span",[e._v(e._s(e._f("setTimeMin")(n.total_time)))])]}}])}),a("el-table-column",{attrs:{label:"总时间/"+("秒"===e.timeUnit?"s":"min"),prop:"classes_time"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["秒"===e.timeUnit?a("span",[e._v(e._s(n.classes_time))]):a("span",[e._v(e._s(e._f("setTimeMin")(n.classes_time)))])]}}])}),a("el-table-column",{attrs:{label:"利用率"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.availability)+"%")])]}}])})],1),a("el-dialog",{attrs:{title:"密炼时间占比曲线图",modal:!0,"close-on-click-modal":!1,"modal-append-to-body":!1,width:"900px",visible:e.dialogVisibleGraph},on:{"update:visible":function(t){e.dialogVisibleGraph=t}}},[a("el-radio-group",{on:{change:e.changeRadioType},model:{value:e.radioDataType,callback:function(t){e.radioDataType=t},expression:"radioDataType"}},[a("el-radio",{attrs:{label:1}},[e._v("车数")]),a("el-radio",{attrs:{label:2}},[e._v("耗时/s")]),a("el-radio",{attrs:{label:3}},[e._v("利用率%")])],1),a("ve-line",{attrs:{height:"500px",data:e.chartData,extend:e.extend,settings:e.chartSettings}})],1)],1)},i=[],s=(a("a623"),a("4160"),a("baa5"),a("d81d"),a("13d5"),a("a9e3"),a("b680"),a("d3b7"),a("ac1f"),a("6062"),a("3ca3"),a("841c"),a("159b"),a("ddb0"),a("2909")),r=a("ade3"),l=(a("96cf"),a("1da1")),o=a("4090"),c=a("befc"),u=a("1f6c"),h=a("2c93"),d={components:{equipSelect:o["a"],timeSpanSelect:c["a"]},mixins:[h["a"]],data:function(){return this.chartSettings={},this.extend={series:{smooth:!1}},{loading:!1,search:{page:1,dimension:1,day_type:2,date:[]},tableData:[],options:["秒","分钟"],timeUnit:"秒",dialogVisibleGraph:!1,chartData:{columns:[],rows:[]},radioDataType:1}},created:function(){this.getList()},methods:{getList:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,Object(u["i"])("get",null,{params:e.search});case 4:a=t.sent,e.tableData=a,e.tableData.length>0&&(2!==Number(e.search.day_type)||1!==e.search.dimension)&&(2===e.search.dimension?n=86400:3===e.search.dimension&&(n=2592e3),e.tableData.forEach((function(e){e.classes_time=n}))),e.tableData.forEach((function(t){e.tableData.length>0&&2===Number(e.search.day_type)&&1===e.search.dimension?t.availability=e.setUse(t.total_time,t.classes_time,!0):2===e.search.dimension?t.availability=e.setUse(t.total_time,86400,!0):3===e.search.dimension&&(t.availability=e.setUse(t.total_time,15552e4,!0))})),e.loading=!1,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},changeDate:function(e){this.search.st=e?e[0]:"",this.search.et=e?e[1]:"",this.getList(),this.search.page=1},changeRadio:function(e){this.search.day_type=e,this.getList(),this.search.page=1},currentChange:function(e){this.search.page=e,this.getList()},equipChanged:function(e){this.search.equip_no=e,this.getList(),this.search.page=1},timeSpanChanged:function(e){this.search.dimension=e,this.getList(),this.search.page=1},setMonth:function(e){if(e){var t=new Date(e);return t.getFullYear()+"/"+(t.getMonth()+1)}},setUse:function(e,t){if(!e||!t)return 0;var a=parseFloat(e/t*100).toFixed(100),n=a.substring(0,a.lastIndexOf(".")+3);return n},setNum:function(e){if(e<0)return e;if(!e)return 0;var t=parseFloat(e/60).toFixed(10),a=t.substring(0,t.lastIndexOf(".")+2);return a},getSummaries:function(e){var t=this,a=e.columns,n=e.data,i=[];return a.forEach((function(e,a){if(0!==a){var s=n.map((function(t){return Number(t[e.property])}));s.every((function(e){return isNaN(e)}))?i[a]:(i[a]=s.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),3===a?i[a]:"秒"!==t.timeUnit?i[a]=t.setNum(i[a]):i[a])}else i[a]="总计"})),i},changeRadioType:function(){this.setLineData()},viewGraph:function(){this.dialogVisibleGraph=!0,this.setLineData()},setLineData:function(){var e=this,t=[],a=[],n={},i=1===this.radioDataType?"total_trains":2===this.radioDataType?"total_time":"availability";for(var l in this.tableData.forEach((function(a){var s,l,o=1===e.search.dimension?a.date+"/"+a.classes:a.date;(t.push(a.equip_no),n[o])?Object.assign(n[o],(s={},Object(r["a"])(s,a.equip_no,a[i]),Object(r["a"])(s,"date",o),s)):n[o]=(l={},Object(r["a"])(l,a.equip_no,a[i]),Object(r["a"])(l,"date",o),l)})),n)a.push(n[l]);t=Object(s["a"])(new Set(t)),t.forEach((function(e){a.forEach((function(t){t[e]||(t[e]=0)}))})),t.unshift("date"),this.chartData.columns=t,this.chartData.rows=a}}},p=d,f=a("2877"),m=Object(f["a"])(p,n,i,!1,null,null,null);t["default"]=m.exports},4090:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-select",{attrs:{clearable:!e.isCreated,placeholder:"请选择机台"},on:{change:e.changeSearch,"visible-change":e.visibleChange},model:{value:e._equip_no,callback:function(t){e._equip_no=t},expression:"_equip_no"}},e._l(e.machineList,(function(e){return a("el-option",{key:e.equip_no,attrs:{label:e.equip_no,value:e.equip_no}})})),1)],1)},i=[],s=a("1f6c"),r={props:{equip_no_props:{type:String,default:null},isCreated:{type:Boolean,default:!1}},data:function(){return{machineList:[]}},computed:{_equip_no:{get:function(){return this.equip_no_props||""},set:function(e){this.$emit("update:equip_no_props",e)}}},created:function(){this.isCreated&&this.getMachineList()},methods:{getMachineList:function(){var e=this;Object(s["j"])("get",{params:{all:1,category_name:"密炼设备"}}).then((function(t){e.machineList=t.results||[],e.isCreated&&(e._equip_no=e.machineList[0].equip_no,e.$emit("changeSearch",e._equip_no))})).catch((function(e){}))},changeSearch:function(e){this.$emit("changeSearch",e)},visibleChange:function(e){e&&0===this.machineList.length&&!this.isCreated&&this.getMachineList()}}},l=r,o=a("2877"),c=Object(o["a"])(l,n,i,!1,null,null,null);t["a"]=c.exports},a623:function(e,t,a){"use strict";var n=a("23e7"),i=a("b727").every,s=a("a640"),r=a("ae40"),l=s("every"),o=r("every");n({target:"Array",proto:!0,forced:!l||!o},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},befc:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-select",{attrs:{placeholder:"请选择时间跨度"},on:{"visible-change":e.visibleChange,change:e.changeSelect},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id,disabled:e.disabled}})})),1)],1)},i=[],s=(a("a9e3"),a("96cf"),a("1da1")),r={props:{defaultVal:{type:Number,default:null},dayType:{type:Number,default:null}},data:function(){return{value:this.defaultVal,options:[{id:1,name:"班次"},{id:2,name:"日"},{id:3,name:"月"}]}},watch:{dayType:function(e){e&&(this.value=1===this.value&&1===e?2:this.value,this.$set(this.options[0],"disabled",2!==e),this.$emit("changeSelect",this.value))}},methods:{getList:function(){return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})))()},visibleChange:function(e){},changeSelect:function(e){this.$emit("changeSelect",e)}}},l=r,o=a("2877"),c=Object(o["a"])(l,n,i,!1,null,null,null);t["a"]=c.exports},d58f:function(e,t,a){var n=a("1c0b"),i=a("7b0b"),s=a("44ad"),r=a("50c4"),l=function(e){return function(t,a,l,o){n(a);var c=i(t),u=s(c),h=r(c.length),d=e?h-1:0,p=e?-1:1;if(l<2)while(1){if(d in u){o=u[d],d+=p;break}if(d+=p,e?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;e?d>=0:h>d;d+=p)d in u&&(o=a(o,u[d],d,c));return o}};e.exports={left:l(!1),right:l(!0)}}}]);