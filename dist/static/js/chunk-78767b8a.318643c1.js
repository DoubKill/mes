(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78767b8a"],{"35d0":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"warehouse-out"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"物料编码:"}},[a("materialCodeSelect",{attrs:{"is-all-obj":!0,"label-name":"no"},on:{changeSelect:e.changeMaterialCode}})],1),a("el-form-item",{attrs:{label:"物料名称:"}},[a("materialCodeSelect",{attrs:{"is-all-obj":!0},on:{changeSelect:e.changeMaterialName}})],1),a("el-form-item",{attrs:{label:"库存位:"}},[a("inventoryPosition",{on:{changSelect:e.changeInventoryPosition}})],1),a("el-form-item",[a("el-button",{on:{click:e.openInfo}},[e._v("操作提示")])],1)],1),a("el-table",{attrs:{data:e.tableData,border:"","row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"No"}}),a("el-table-column",{attrs:{prop:"spare_no",label:"物料编码"}}),a("el-table-column",{attrs:{prop:"spare_name",label:"物料名称"}}),a("el-table-column",{attrs:{prop:"location_name",label:"库存位"}}),a("el-table-column",{attrs:{prop:"qty",label:"数量"}}),a("el-table-column",{attrs:{prop:"unit",label:"单位"}}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["stock_count","change"],expression:"['stock_count','change']"}],attrs:{size:"mini"},on:{click:function(a){return e.edit(t.row)}}},[e._v("更改 ")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["stock_count","history"],expression:"['stock_count','history']"}],attrs:{size:"mini",type:"blue"},on:{click:function(a){return e.view(t.row)}}},[e._v("查看履历 ")])],1)]}}])})],1),a("page",{attrs:{"old-page":!1,total:e.total,"current-page":e.search.page},on:{currentChange:e.currentChange}}),a("el-dialog",{attrs:{title:"盘点",visible:e.dialogVisible,width:"55%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.currentRow,rules:e.rules,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"物料编码",prop:"spare"}},[a("materialCodeSelect",{attrs:{"created-is":!0,"is-all-obj":!0,"default-val":e.currentRow.spare,"is-disabled":!0,"label-name":"no"},on:{changeSelect:e.dialogMaterialFun}})],1),a("el-form-item",{attrs:{label:"物料名称",prop:"b"}},[a("materialCodeSelect",{attrs:{"created-is":!0,"is-all-obj":!0,"default-val":e.currentRow.spare,"is-disabled":!0},on:{changeSelect:e.dialogMaterialFun}})],1),a("el-form-item",{attrs:{label:"库存位"}},[a("inventoryPosition",{attrs:{"created-is":!0,"default-val":e.currentRow.location,"is-disabled":!0},on:{changSelect:e.dialogInventoryPosition}})],1),a("el-form-item",{attrs:{label:"数量",prop:"qty"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:e.currentRow.qty,callback:function(t){e.$set(e.currentRow,"qty",t)},expression:"currentRow.qty"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.currentRow.reason,callback:function(t){e.$set(e.currentRow,"reason",t)},expression:"currentRow.reason"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.handleClose(null)}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitFun}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"备品备件盘点履历",visible:e.dialogVisibleResume,width:"90%"},on:{"update:visible":function(t){e.dialogVisibleResume=t}}},[a("allRecord",{attrs:{"is-dialog":!0,show:e.dialogVisibleResume,"dialog-obj":e.dialogObj}})],1)],1)},r=[],i=(a("053b"),a("e35a"),a("9cf3"),a("6a61"),a("cf7f")),l=a("8041"),o=a("5c1c"),s=a("3e51"),c=a("d585"),u=a("2f91"),d={components:{allRecord:u["default"],page:s["a"],inventoryPosition:l["a"],materialCodeSelect:o["a"]},data:function(){return{search:{page:1,page_size:10},tableData:[],dialogVisible:!1,dialogVisibleResume:!1,currentRow:{},dialogObj:{},total:0,restaurants:[],loading:!1,rules:{spare:[{required:!0,message:"请输入物料编码",trigger:"change"}],b:[{required:!0,message:"请输入物料名称",trigger:"change"}],qty:[{required:!0,message:"请输入数量",trigger:"blur"}]}}},created:function(){this.getList()},methods:{getList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,Object(c["k"])("get",null,{params:e.search});case 4:a=t.sent,e.tableData=a.results,e.total=a.count,t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](0);case 11:e.loading=!1;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},changeInventoryPosition:function(e){this.search.location_name=e?e.name:null,this.search.page=1,this.getList()},changeMaterialCode:function(e){this.search.spare_no=e?e.no:null,this.search.page=1,this.getList()},changeMaterialName:function(e){this.search.spare_name=e?e.name:null,this.search.page=1,this.getList()},edit:function(e){this.currentRow=JSON.parse(JSON.stringify(e)),this.currentRow.b=e.spare_name,this.dialogVisible=!0},view:function(e){this.dialogVisibleResume=!0,this.dialogObj=e},handleClose:function(e){this.currentRow={},this.$refs.ruleForm.resetFields(),this.dialogVisible=!1,e&&e()},submitFun:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=16;break}return t.prev=1,n={},n.qty=e.currentRow.qty,n.reason=e.currentRow.reason,t.next=7,Object(c["m"])("post",e.currentRow.id,{data:n});case 7:e.$message.success("盘点操作成功"),e.handleClose(null),e.getList(),t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](1);case 14:t.next=18;break;case 16:return console.log(222),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}())},dialogMaterialFun:function(e){this.$set(this.currentRow,"b",e?e.name:""),this.$set(this.currentRow,"spare",e?e.id:"")},dialogInventoryPosition:function(e){this.$set(this.currentRow,"location",e?e.id:"")},currentChange:function(e,t){this.search.page=e,this.search.page_size=t,this.getList()},tableRowClassName:function(e){var t=e.row;e.rowIndex;return"-"===t.bound?"warning-row":"+"===t.bound?"max-warning-row":""},openInfo:function(){var e=this.$createElement;this.$msgbox({title:"操作提示",message:e("p",null,[e("div",null,"1、发现数量不对点击更改修改数量"),e("div",null,"2、发现货位和备品备件不一致请先出库再入库"),e("div",null,"3、发现备品备件不可用，先出库再给报废编号")])})}}},b=d,m=(a("84cb"),a("9ca4")),g=Object(m["a"])(b,n,r,!1,null,null,null);t["default"]=g.exports},"84cb":function(e,t,a){"use strict";var n=a("97da"),r=a.n(n);r.a},"97da":function(e,t,a){}}]);